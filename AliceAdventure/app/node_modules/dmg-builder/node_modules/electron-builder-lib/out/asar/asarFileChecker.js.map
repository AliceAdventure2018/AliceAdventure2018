{"version":3,"file":"asarFileChecker.js","sourceRoot":"","sources":["../../src/asar/asarFileChecker.ts"],"names":[],"mappings":";;;;;;;AAAA,AAAO,AAAE,AAAU,AAAE,AAAM,AAAqB;;;;;;;;;;AAChD,AAAO,AAAQ,AAAQ,AAAE,AAAM,AAAQ;;;;;;;;;;AAEvC,AAAgB,AAChB,AAAM;AAAC,AAAK,kCAA6B,AAAgB,UAAE,AAAoB,cAAE,AAAqB;AACpG,iBAAe,AAAY;AACzB,AAAM,WAAC,IAAI,AAAK,AAAC,SAAG,AAAa,kBAAK,AAAY,yBAAa,AAAQ,aAAK,AAAI,IAAE,AAAC,AACrF;AAAC;;AAED,MAAI,AAAE;;AACN,MAAI,AAAC;AACH,AAAE,SAAG,MAAM,AAAQ,sBAAC,AAAQ,AAAC,AAC/B;AAAC,IACD,AAAK,AAAC,OAAC,AAAC,AAAC,GAAC,AAAC;AACT,UAAM,AAAK,AAAC,uBAAiB,AAAC,CAAE,AAAC,AACnC;AAAC;;AAED,MAAI,AAAiB;;AACrB,MAAI,AAAC;AACH,AAAI,WAAG,AAAE,GAAC,AAAO,QAAC,AAAY,AAAC,AACjC;AAAC,IACD,AAAK,AAAC,OAAC,AAAC,AAAC;AACP,UAAM,AAAQ,WAAG,MAAM,AAAU,sBAAC,AAAQ,AAAC;;AAC3C,AAAE,AAAC,QAAC,AAAQ,YAAI,AAAI,AAAC,MAAC,AAAC;AACrB,YAAM,AAAK,AAAC,MAAmD,AAAC,AAClE;AAAC,KAJO,AAAC,CAMT,AAA8D;;;AAC9D,AAAI,WAAG,AAAI,AACb;AAAC;;AAED,AAAE,AAAC,MAAC,AAAI,QAAI,AAAI,AAAC,MAAC,AAAC;AACjB,UAAM,AAAK,AAAC,MAAmD,AAAC,AAClE;AAAC;;AACD,AAAE,AAAC,MAAC,AAAI,KAAC,AAAI,SAAK,AAAC,AAAC,GAAC,AAAC;AACpB,UAAM,AAAK,AAAC,MAAsB,AAAC,AACrC;AAAC,AACH;AAAC","sourcesContent":["import { statOrNull } from \"builder-util/out/fs\"\nimport { Node, readAsar } from \"./asar\"\n\n/** @internal */\nexport async function checkFileInArchive(asarFile: string, relativeFile: string, messagePrefix: string) {\n  function error(text: string) {\n    return new Error(`${messagePrefix} \"${relativeFile}\" in the \"${asarFile}\" ${text}`)\n  }\n\n  let fs\n  try {\n    fs = await readAsar(asarFile)\n  }\n  catch (e) {\n    throw error(`is corrupted: ${e}`)\n  }\n\n  let stat: Node | null\n  try {\n    stat = fs.getFile(relativeFile)\n  }\n  catch (e) {\n    const fileStat = await statOrNull(asarFile)\n    if (fileStat == null) {\n      throw error(`does not exist. Seems like a wrong configuration.`)\n    }\n\n    // asar throws error on access to undefined object (info.link)\n    stat = null\n  }\n\n  if (stat == null) {\n    throw error(`does not exist. Seems like a wrong configuration.`)\n  }\n  if (stat.size === 0) {\n    throw error(`is corrupted: size 0`)\n  }\n}\n"]}
